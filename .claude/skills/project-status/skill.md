---
name: project-status
description: 快速查询项目状态、进度、WBS任务完成情况和下一步工作建议，避免读取多个文档
version: 1.0.0
---

# 项目状态查询器

快速了解《星穹铁道剧情复现计划》项目的全局状态，集成多个文档的关键信息，提供一站式项目概览。

## 功能

1. **进度概览** - 当前阶段、完成度、里程碑
2. **WBS 任务统计** - 已完成/进行中/待开始任务数量
3. **测试状态** - 测试通过率、覆盖率、失败用例
4. **下一步建议** - 基于当前进度的工作建议
5. **Git 状态** - 分支、未提交变更、最近提交
6. **模块完成度** - 9 个模块的完成状态

## 核心数据缓存

### Phase 2 项目状态（2026-02-21 更新）

**当前阶段**: Phase 2 功能扩展完成，测试完成

**整体进度**:

- Phase 1 开发：✅ 100% (9/9 模块)
- Phase 1 测试：✅ 100% (227/227 tests)
- Phase 2 开发：✅ 100% (8/8 任务)
- Phase 2 测试：✅ 100% (380/380 tests)

**Phase 2 验收标准**（8 项）：

1. ✅ P2-CS-01 势力、多角色关系网维护；触发表扩展
2. ✅ P2-WE-01 道具状态、分支定义、多场景切换
3. ✅ P2-SO-01 快照保存与读档；当前分支状态可恢复
4. ✅ P2-CA-01 多人在场时冲突裁决逻辑；无死锁
5. ✅ P2-EI-01 至少一种冲突策略可用且文档化（4种）
6. ✅ P2-AE-01 报告含「人物视野与判断」维度及差异说明
7. ✅ P2-UI-01 支持多角色剧情展示、快照列表与读档、对比报告展示
8. ✅ P2-VM-01 推理规则配置；遗忘/模糊触发条件与执行

**测试状态**：

- 总测试：380 个
- 通过：380 个（100%）
- 失败：0 个
- Core 包：285 个测试 ✅
- Infrastructure 包：92 个测试，覆盖率 90% ✅
- API 包：3 个测试 ✅

**已完成模块**（Phase 1: 9/9，Phase 2: 8/8）：

Phase 1：

- DEV-P1-01 基础设施与数据模型 ✅
- DEV-P1-02 视野与信息 ✅
- DEV-P1-03 人物状态演化 ✅
- DEV-P1-04 输入解析 ✅
- DEV-P1-05 角色Agent ✅
- DEV-P1-06 剧情编排 ✅
- DEV-P1-07 导出导入 ✅
- DEV-P1-08 锚点与对比 ✅
- DEV-P1-09 表现层UI ✅

Phase 2：

- P2-CS-01 多角色状态与势力/关系扩展 ✅
- P2-WE-01 道具与剧情节点/分支 ✅
- P2-SO-01 快照保存与加载 ✅
- P2-CA-01 多 Agent 冲突裁决 ✅
- P2-EI-01 导入冲突策略可配置 ✅
- P2-AE-01 判断维度对比报告 ✅
- P2-UI-01 多角色/快照/读档 UI ✅
- P2-VM-01 信息推理/遗忘/模糊规则 ✅

**下一步工作**（Phase 2 收尾 / Phase 3 规划）：

1. Phase 2 QA 回归测试（端到端验证）
2. Phase 3 规划（LLM 语义冲突检测、批量锚点对比、Web UI 对接后端 API）
3. 发布准备（打 tag v2.0.0-rc.1）

4. QA-P1-02 功能测试 + 回归测试
5. QA-P1-03 发布准备（文档、部署脚本）
6. REL-P1-01 内测/灰度发布

**技术栈**：

- 语言：TypeScript 5.x
- 构建：pnpm workspace + tsup
- 测试：Jest + ts-jest
- LLM：Deepseek + Claude (通过统一接口)
- 存储：JSON 文件存储

## 使用方法

### 1. 查询当前进度

```bash
# 快速查看项目状态
# 返回：当前阶段、完成度、下一步工作
```

**输出示例**：

```
📊 项目状态概览

当前阶段：Phase 1 MVP 开发完成
整体进度：100% (9/9 模块完成)

✅ 已完成
- 9 个开发模块
- 227 个测试用例（100% 通过）
- 9 份模块文档

📋 下一步工作
1. QA-P1-02 功能测试 + 回归测试
2. QA-P1-03 发布准备
3. REL-P1-01 内测/灰度发布
```

### 2. 查询 WBS 任务统计

```bash
# 统计 WBS 任务完成情况
grep -E "P1-[A-Z]+-[0-9]+" docs/WBS任务分解表.md | wc -l
```

**输出示例**：

```
📊 WBS 任务统计

Phase 1 任务：
- 总任务：30 个
- 已完成：30 个 ✅
- 进行中：0 个
- 待开始：0 个
- 完成率：100%

任务分布：
- 基础设施 (INF): 3/3 ✅
- 视野管理 (VM): 3/3 ✅
- 人物状态 (CS): 3/3 ✅
- 输入解析 (IP): 3/3 ✅
- 世界引擎 (WE): 2/2 ✅
- 角色Agent (CA): 3/3 ✅
- 剧情编排 (SO): 2/2 ✅
- 导出导入 (EI): 3/3 ✅
- 锚点对比 (AC): 3/3 ✅
- 表现层UI (UI): 2/2 ✅
- 测试 (QA): 3/3 ✅
```

### 3. 查询测试状态

```bash
# 快速查看测试状态（从缓存）
# 或执行：pnpm test 获取最新状态
```

**输出示例**：

```
🧪 测试状态

总体：
- 测试套件：9 个
- 测试用例：227 个
- 通过率：100% ✅
- 失败：0 个

覆盖率：
- Core 包：82.75% ✅ (超标)
- Infrastructure 包：46.70% ⚠️ (未达标)

验收标准测试：
1. 视野隔离验证：✅ 通过
2. 剧情推进可控：✅ 通过
3. 导出/导入可用：✅ 通过
4. 对比结果可见：✅ 通过
5. 状态演化可配置：✅ 通过
```

### 4. 查询模块完成度

```bash
# 列出所有模块文档
ls docs/modules/ | grep "DEV-P1"
```

**输出示例**：

```
📦 模块完成度

Phase 1 模块（9/9）：

✅ DEV-P1-01 基础设施与数据模型
   - 文档：docs/modules/DEV-P1-01-基础设施与数据模型.md
   - 测试：34 个（100% 通过）
   - 状态：已完成

✅ DEV-P1-02 视野与信息
   - 文档：docs/modules/DEV-P1-02-视野与信息.md
   - 测试：12 个（100% 通过）
   - 状态：已完成

✅ DEV-P1-03 人物状态演化
   - 文档：docs/modules/DEV-P1-03-人物状态演化.md
   - 测试：22 个（100% 通过）
   - 状态：已完成

... (其他模块)
```

### 5. 查询 Git 状态

```bash
# 查看 Git 状态
git status --short
git log --oneline -5
```

**输出示例**：

```
🔧 Git 状态

当前分支：main
未提交变更：0 个文件

最近提交：
a3f0507 refactor: Refactor code structure
6a0d394 feat: add demo session creation script
4a01592 feat: 修复环境变量加载问题
c58b39a feat: 优化 CLI 路径处理
ac9f939 feat: 增强 CLI 功能
```

### 6. 查询下一步工作

基于当前进度，智能推荐下一步工作。

**输出示例**：

```
🎯 下一步工作建议

基于当前状态（Phase 1 开发完成），建议：

优先级 P0（必须完成）：
1. QA-P1-02 功能测试 + 回归测试
   - 执行端到端测试
   - 验证 5 项验收标准
   - 记录测试结果

2. QA-P1-03 发布准备
   - 完善 README 和使用文档
   - 准备部署脚本
   - 创建 CHANGELOG

3. REL-P1-01 内测/灰度发布
   - 选择内测用户
   - 收集反馈
   - 修复关键问题

优先级 P1（建议完成）：
- 提升 Infrastructure 包测试覆盖率（当前 46.70%）
- 为 LLM Provider、Logger、Error Handler 添加测试
- 优化文档（补充使用示例）

优先级 P2（可选）：
- 性能优化和基准测试
- 代码重构和技术债务清理
```

## 快速查询命令

### 项目文件统计

```bash
# 统计代码行数
find packages -name "*.ts" -not -path "*/node_modules/*" -not -path "*/__tests__/*" | xargs wc -l | tail -1

# 统计测试文件数
find packages -name "*.test.ts" | wc -l

# 统计模块文档数
ls docs/modules/ | grep "DEV-P1" | wc -l
```

### 依赖检查

```bash
# 检查依赖是否安装
pnpm list --depth=0

# 检查过期依赖
pnpm outdated
```

### 构建状态

```bash
# 快速构建检查
pnpm build

# 检查类型错误
pnpm type-check
```

## 状态查询策略

### 三层查询策略

1. **缓存优先** - 使用 skill 内置的缓存数据（即时响应）
2. **文档查询** - 使用 grep 快速提取关键信息（1-2s）
3. **实时执行** - 执行命令获取最新状态（5-30s）

### 何时使用缓存

- 查询 Phase 1 基本信息（模块列表、验收标准）
- 查询项目结构和技术栈
- 查询 WBS 任务分类

### 何时查询文档

- 查询具体任务详情
- 查询模块文档内容
- 查询测试用例设计

### 何时实时执行

- 查询最新测试结果
- 查询 Git 状态
- 查询构建状态
- 查询依赖版本

## 集成查询示例

### 完整项目状态报告

```
📊 《星穹铁道剧情复现计划》项目状态报告
生成时间：2026-02-18

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📈 整体进度

当前阶段：Phase 1 MVP 开发完成
完成度：100% (9/9 模块)
状态：✅ 开发完成，测试通过，准备发布

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📦 模块完成度

✅ 已完成：9 个模块
- DEV-P1-01 基础设施与数据模型
- DEV-P1-02 视野与信息
- DEV-P1-03 人物状态演化
- DEV-P1-04 输入解析
- DEV-P1-05 角色Agent
- DEV-P1-06 剧情编排
- DEV-P1-07 导出导入
- DEV-P1-08 锚点与对比
- DEV-P1-09 表现层UI

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🧪 测试状态

总测试：227 个
通过：227 个（100%）
失败：0 个

覆盖率：
- Core 包：82.75% ✅ (超标 22.75%)
- Infrastructure 包：46.70% ⚠️ (差 13.3%)

验收标准：5/5 通过 ✅

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📋 WBS 任务

Phase 1 任务：30/30 完成 ✅
- 基础设施：3/3 ✅
- 视野管理：3/3 ✅
- 人物状态：3/3 ✅
- 输入解析：3/3 ✅
- 世界引擎：2/2 ✅
- 角色Agent：3/3 ✅
- 剧情编排：2/2 ✅
- 导出导入：3/3 ✅
- 锚点对比：3/3 ✅
- 表现层UI：2/2 ✅
- 测试：3/3 ✅

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🔧 技术栈

语言：TypeScript 5.x
包管理：pnpm workspace
构建：tsup
测试：Jest + ts-jest
LLM：Deepseek + Claude
存储：JSON 文件

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🎯 下一步工作

P0（必须）：
1. QA-P1-02 功能测试 + 回归测试
2. QA-P1-03 发布准备
3. REL-P1-01 内测/灰度发布

P1（建议）：
- 提升 Infrastructure 包测试覆盖率
- 补充 LLM Provider 测试

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

## Token 优化

### 对比传统方式

**传统方式**（需要读取多个文档）：

1. 读取 WBS任务分解表.md（5000 tokens）
2. 读取 项目进度表.md（2000 tokens）
3. 读取 Phase1-测试完成总结.md（3000 tokens）
4. 执行 git status（500 tokens）
5. 执行 pnpm test（2000 tokens）

**总计**：12,500 tokens

**使用 project-status skill**：

- 缓存数据：500 tokens
- 必要时执行命令：1000 tokens

**总计**：1,500 tokens

**节省**：11,000 tokens（**88% 节省**）

## 缓存更新策略

### 何时更新缓存

- 完成新模块时
- 测试状态变化时
- 进入新阶段时
- 验收标准变化时

### 手动更新缓存

当项目状态发生重大变化时，更新 skill 文档中的缓存数据：

```markdown
### Phase 1 项目状态（更新日期）

**当前阶段**: ...
**整体进度**: ...
**测试状态**: ...
```

## 注意事项

1. **缓存时效性** - 缓存数据可能不是最新的，关键决策前建议实时查询
2. **Git 状态** - Git 状态始终实时查询，不使用缓存
3. **测试结果** - 测试结果建议实时执行获取最新数据
4. **文档同步** - 完成新模块后记得更新缓存

## 更新日志

- v1.0.0 (2026-02-18) - 初始版本，支持项目状态快速查询
